<!DOCTYPE html>

<html>
<head>
  <title>jquery.event.drag-2.2.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="board.html">
                  board.js
                </a>
              
                
                <a class="source" href="config.html">
                  config.js
                </a>
              
                
                <a class="source" href="app.html">
                  app.js
                </a>
              
                
                <a class="source" href="initialize.html">
                  initialize.js
                </a>
              
                
                <a class="source" href="whiteboard.html">
                  whiteboard.js
                </a>
              
                
                <a class="source" href="jquery.event.drag-2.2.html">
                  jquery.event.drag-2.2.js
                </a>
              
                
                <a class="source" href="server.html">
                  server.js
                </a>
              
                
                <a class="source" href="sockets.html">
                  sockets.js
                </a>
              
                
                <a class="source" href="dbTest.html">
                  dbTest.js
                </a>
              
                
                <a class="source" href="liveServerSpec.html">
                  liveServerSpec.js
                </a>
              
                
                <a class="source" href="serverSpec.html">
                  serverSpec.js
                </a>
              
                
                <a class="source" href="stubs.html">
                  stubs.js
                </a>
              
                
                <a class="source" href="test.html">
                  test.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>jquery.event.drag-2.2.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*! 
 * jquery.event.drag - v 2.2
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Created: 2008-06-04 
Updated: 2012-05-21
REQUIRES: jquery 1.7.x</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
;(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> $ </span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>add the jquery instance method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.fn.drag = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> str, arg, opts </span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>figure out the event type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> type = <span class="hljs-keyword">typeof</span> str == <span class="hljs-string">"string"</span> ? str : <span class="hljs-string">""</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>figure out the event handler…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	fn = $.isFunction( str ) ? str : $.isFunction( arg ) ? arg : <span class="hljs-literal">null</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>fix the event type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">if</span> ( type.indexOf(<span class="hljs-string">"drag"</span>) !== <span class="hljs-number">0</span> ) 
		type = <span class="hljs-string">"drag"</span>+ type;</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>were options passed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	opts = ( str == fn ? arg : opts ) || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>trigger or bind event handler</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">return</span> fn ? <span class="hljs-keyword">this</span>.bind( type, opts, fn ) : <span class="hljs-keyword">this</span>.trigger( type );
};</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>local refs (increase compression)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> $event = $.event, 
$special = $event.special,</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>configure the drag special event </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>drag = $special.drag = {</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>these are the default settings</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	defaults: {
		which: <span class="hljs-number">1</span>, <span class="hljs-comment">// mouse button pressed to start drag sequence</span>
		distance: <span class="hljs-number">0</span>, <span class="hljs-comment">// distance dragged before dragstart</span>
		not: <span class="hljs-string">':input'</span>, <span class="hljs-comment">// selector to suppress dragging on target elements</span>
		handle: <span class="hljs-literal">null</span>, <span class="hljs-comment">// selector to match handle target elements</span>
		relative: <span class="hljs-literal">false</span>, <span class="hljs-comment">// true to use "position", false to use "offset"</span>
		drop: <span class="hljs-literal">true</span>, <span class="hljs-comment">// false to suppress drop events, true or selector to allow</span>
		click: <span class="hljs-literal">false</span> <span class="hljs-comment">// false to suppress click events after dragend (no proxy)</span>
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>the key name for stored drag data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	datakey: <span class="hljs-string">"dragdata"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>prevent bubbling for better performance</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	noBubble: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>count bound related events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	add: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> obj </span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>read the interaction data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> data = $.data( <span class="hljs-keyword">this</span>, drag.datakey ),</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>read any passed options </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		opts = obj.data || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>count another realted event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		data.related += <span class="hljs-number">1</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>extend data options bound with this event
don’t iterate “opts” in case it is a node </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.each( drag.defaults, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> key, def </span>)</span>{
			<span class="hljs-keyword">if</span> ( opts[ key ] !== <span class="hljs-literal">undefined</span> )
				data[ key ] = opts[ key ];
		});
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>forget unbound related events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	remove: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
		$.data( <span class="hljs-keyword">this</span>, drag.datakey ).related -= <span class="hljs-number">1</span>;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>configure interaction, capture settings</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	setup: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>check for related events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $.data( <span class="hljs-keyword">this</span>, drag.datakey ) ) 
			<span class="hljs-keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>initialize the drag data with copied defaults</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> data = $.extend({ related:<span class="hljs-number">0</span> }, drag.defaults );</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>store the interaction data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.data( <span class="hljs-keyword">this</span>, drag.datakey, data );</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>bind the mousedown event, which starts drag interactions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$event.add( <span class="hljs-keyword">this</span>, <span class="hljs-string">"touchstart mousedown"</span>, drag.init, data );</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>prevent image dragging in IE…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.attachEvent ) 
			<span class="hljs-keyword">this</span>.attachEvent(<span class="hljs-string">"ondragstart"</span>, drag.dontstart ); 
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>destroy configured interaction</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	teardown: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
		<span class="hljs-keyword">var</span> data = $.data( <span class="hljs-keyword">this</span>, drag.datakey ) || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>check for related events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( data.related ) 
			<span class="hljs-keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>remove the stored data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.removeData( <span class="hljs-keyword">this</span>, drag.datakey );</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>remove the mousedown event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$event.remove( <span class="hljs-keyword">this</span>, <span class="hljs-string">"touchstart mousedown"</span>, drag.init );</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>enable text selection</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		drag.textselect( <span class="hljs-literal">true</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>un-prevent image dragging in IE…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.detachEvent ) 
			<span class="hljs-keyword">this</span>.detachEvent(<span class="hljs-string">"ondragstart"</span>, drag.dontstart ); 
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>initialize the interaction</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	init: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>sorry, only one touch at a time</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( drag.touched ) 
			<span class="hljs-keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>the drag/drop interaction data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> dd = event.data, results;</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>check the which directive</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( event.which != <span class="hljs-number">0</span> &amp;&amp; dd.which &gt; <span class="hljs-number">0</span> &amp;&amp; event.which != dd.which ) 
			<span class="hljs-keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>check for suppressed selector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( $( event.target ).is( dd.not ) ) 
			<span class="hljs-keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>check for handle selector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( dd.handle &amp;&amp; !$( event.target ).closest( dd.handle, event.currentTarget ).length ) 
			<span class="hljs-keyword">return</span>;

		drag.touched = event.type == <span class="hljs-string">'touchstart'</span> ? <span class="hljs-keyword">this</span> : <span class="hljs-literal">null</span>;
		dd.propagates = <span class="hljs-number">1</span>;
		dd.mousedown = <span class="hljs-keyword">this</span>;
		dd.interactions = [ drag.interaction( <span class="hljs-keyword">this</span>, dd ) ];
		dd.target = event.target;
		dd.pageX = event.pageX;
		dd.pageY = event.pageY;
		dd.dragging = <span class="hljs-literal">null</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>handle draginit event… </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		results = drag.hijack( event, <span class="hljs-string">"draginit"</span>, dd );</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>early cancel</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !dd.propagates )
			<span class="hljs-keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>flatten the result set</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		results = drag.flatten( results );</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>insert new interaction elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( results &amp;&amp; results.length ){
			dd.interactions = [];
			$.each( results, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
				dd.interactions.push( drag.interaction( <span class="hljs-keyword">this</span>, dd ) );
			});
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>remember how many interactions are propagating</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		dd.propagates = dd.interactions.length;</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>locate and init the drop targets</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( dd.drop !== <span class="hljs-literal">false</span> &amp;&amp; $special.drop ) 
			$special.drop.handler( event, dd );</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>disable text selection</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		drag.textselect( <span class="hljs-literal">false</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>bind additional events…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( drag.touched )
			$event.add( drag.touched, <span class="hljs-string">"touchmove touchend"</span>, drag.handler, dd );
		<span class="hljs-keyword">else</span> 
			$event.add( <span class="hljs-built_in">document</span>, <span class="hljs-string">"mousemove mouseup"</span>, drag.handler, dd );</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>helps prevent text selection or scrolling</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !drag.touched || dd.live )
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>returns an interaction object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	interaction: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> elem, dd </span>)</span>{
		<span class="hljs-keyword">var</span> offset = $( elem )[ dd.relative ? <span class="hljs-string">"position"</span> : <span class="hljs-string">"offset"</span> ]() || { top:<span class="hljs-number">0</span>, left:<span class="hljs-number">0</span> };
		<span class="hljs-keyword">return</span> {
			drag: elem, 
			callback: <span class="hljs-keyword">new</span> drag.callback(), 
			droppable: [],
			offset: offset
		};
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>handle drag-releatd DOM events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	handler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>read the data before hijacking anything</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> dd = event.data;</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>handle various events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">switch</span> ( event.type ){</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>mousemove, check distance, start dragging</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">case</span> !dd.dragging &amp;&amp; <span class="hljs-string">'touchmove'</span>: 
				event.preventDefault();
			<span class="hljs-keyword">case</span> !dd.dragging &amp;&amp; <span class="hljs-string">'mousemove'</span>:</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p> drag tolerance, x� + y� = distance�</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( <span class="hljs-built_in">Math</span>.pow(  event.pageX-dd.pageX, <span class="hljs-number">2</span> ) + <span class="hljs-built_in">Math</span>.pow(  event.pageY-dd.pageY, <span class="hljs-number">2</span> ) &lt; <span class="hljs-built_in">Math</span>.pow( dd.distance, <span class="hljs-number">2</span> ) ) 
					<span class="hljs-keyword">break</span>; <span class="hljs-comment">// distance tolerance not reached</span>
				event.target = dd.target; <span class="hljs-comment">// force target from "mousedown" event (fix distance issue)</span>
				drag.hijack( event, <span class="hljs-string">"dragstart"</span>, dd ); <span class="hljs-comment">// trigger "dragstart"</span>
				<span class="hljs-keyword">if</span> ( dd.propagates ) <span class="hljs-comment">// "dragstart" not rejected</span>
					dd.dragging = <span class="hljs-literal">true</span>; <span class="hljs-comment">// activate interaction</span></pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>mousemove, dragging</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">case</span> <span class="hljs-string">'touchmove'</span>:
				event.preventDefault();
			<span class="hljs-keyword">case</span> <span class="hljs-string">'mousemove'</span>:
				<span class="hljs-keyword">if</span> ( dd.dragging ){</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>trigger “drag”        </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					drag.hijack( event, <span class="hljs-string">"drag"</span>, dd );
					<span class="hljs-keyword">if</span> ( dd.propagates ){</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>manage drop events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">if</span> ( dd.drop !== <span class="hljs-literal">false</span> &amp;&amp; $special.drop )
							$special.drop.handler( event, dd ); <span class="hljs-comment">// "dropstart", "dropend"							</span>
						<span class="hljs-keyword">break</span>; <span class="hljs-comment">// "drag" not rejected, stop		</span>
					}
					event.type = <span class="hljs-string">"mouseup"</span>; <span class="hljs-comment">// helps "drop" handler behave</span>
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>mouseup, stop dragging</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">case</span> <span class="hljs-string">'touchend'</span>: 
			<span class="hljs-keyword">case</span> <span class="hljs-string">'mouseup'</span>: 
			<span class="hljs-keyword">default</span>:
				<span class="hljs-keyword">if</span> ( drag.touched )
					$event.remove( drag.touched, <span class="hljs-string">"touchmove touchend"</span>, drag.handler ); <span class="hljs-comment">// remove touch events</span>
				<span class="hljs-keyword">else</span> 
					$event.remove( <span class="hljs-built_in">document</span>, <span class="hljs-string">"mousemove mouseup"</span>, drag.handler ); <span class="hljs-comment">// remove page events	</span>
				<span class="hljs-keyword">if</span> ( dd.dragging ){
					<span class="hljs-keyword">if</span> ( dd.drop !== <span class="hljs-literal">false</span> &amp;&amp; $special.drop )
						$special.drop.handler( event, dd ); <span class="hljs-comment">// "drop"</span>
					drag.hijack( event, <span class="hljs-string">"dragend"</span>, dd ); <span class="hljs-comment">// trigger "dragend"	</span>
				}
				drag.textselect( <span class="hljs-literal">true</span> ); <span class="hljs-comment">// enable text selection</span></pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>if suppressing click events…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( dd.click === <span class="hljs-literal">false</span> &amp;&amp; dd.dragging )
					$.data( dd.mousedown, <span class="hljs-string">"suppress.click"</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime() + <span class="hljs-number">5</span> );
				dd.dragging = drag.touched = <span class="hljs-literal">false</span>; <span class="hljs-comment">// deactivate element	</span>
				<span class="hljs-keyword">break</span>;
		}
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>re-use event object for custom events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	hijack: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event, type, dd, x, elem </span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>not configured</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> ( !dd ) 
			<span class="hljs-keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>remember the original event and type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> orig = { event:event.originalEvent, type:event.type },</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>is the event drag related or drog related?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		mode = type.indexOf(<span class="hljs-string">"drop"</span>) ? <span class="hljs-string">"drag"</span> : <span class="hljs-string">"drop"</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>iteration vars</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		result, i = x || <span class="hljs-number">0</span>, ia, $elems, callback,
		len = !<span class="hljs-built_in">isNaN</span>( x ) ? x : dd.interactions.length;</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>modify the event type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		event.type = type;</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>remove the original event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		event.originalEvent = <span class="hljs-literal">null</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>initialize the results</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		dd.results = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>handle each interacted element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">do</span> <span class="hljs-keyword">if</span> ( ia = dd.interactions[ i ] ){</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>validate the interaction</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( type !== <span class="hljs-string">"dragend"</span> &amp;&amp; ia.cancelled )
				<span class="hljs-keyword">continue</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>set the dragdrop properties on the event object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			callback = drag.properties( event, dd, ia );</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>prepare for more results</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			ia.results = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>handle each element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			$( elem || ia[ mode ] || dd.droppable ).each(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> p, subject </span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>identify drag or drop targets individually</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				callback.target = subject;</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>force propagtion of the custom event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				event.isPropagationStopped = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; };</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>handle the event    </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				result = subject ? $event.dispatch.call( subject, event, callback ) : <span class="hljs-literal">null</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>stop the drag interaction for this element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( result === <span class="hljs-literal">false</span> ){
					<span class="hljs-keyword">if</span> ( mode == <span class="hljs-string">"drag"</span> ){
						ia.cancelled = <span class="hljs-literal">true</span>;
						dd.propagates -= <span class="hljs-number">1</span>;
					}
					<span class="hljs-keyword">if</span> ( type == <span class="hljs-string">"drop"</span> ){
						ia[ mode ][p] = <span class="hljs-literal">null</span>;
					}
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>assign any dropinit elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( type == <span class="hljs-string">"dropinit"</span> )
					ia.droppable.push( drag.element( result ) || subject );</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>accept a returned proxy element </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( type == <span class="hljs-string">"dragstart"</span> )
					ia.proxy = $( drag.element( result ) || ia.drag )[<span class="hljs-number">0</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>remember this result    </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				ia.results.push( result );</pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p>forget the event result, for recycling</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">delete</span> event.result;</pre></div></div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p>break on cancelled handler</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> ( type !== <span class="hljs-string">"dropinit"</span> )
					<span class="hljs-keyword">return</span> result;
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p>flatten the results    </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			dd.results[ i ] = drag.flatten( ia.results );</pre></div></div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <p>accept a set of valid drop targets</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( type == <span class="hljs-string">"dropinit"</span> )
				ia.droppable = drag.flatten( ia.droppable );</pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p>locate drop targets</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( type == <span class="hljs-string">"dragstart"</span> &amp;&amp; !ia.cancelled )
				callback.update(); 
		}
		<span class="hljs-keyword">while</span> ( ++i &lt; len )</pre></div></div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p>restore the original event &amp; type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		event.type = orig.type;
		event.originalEvent = orig.event;</pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>return all handler results</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> drag.flatten( dd.results );
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-85">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <p>extend the callback object with drag/drop properties…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	properties: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event, dd, ia </span>)</span>{		
		<span class="hljs-keyword">var</span> obj = ia.callback;</pre></div></div>
            
        </li>
        
        
        <li id="section-86">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              <p>elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		obj.drag = ia.drag;
		obj.proxy = ia.proxy || ia.drag;</pre></div></div>
            
        </li>
        
        
        <li id="section-87">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>starting mouse position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		obj.startX = dd.pageX;
		obj.startY = dd.pageY;</pre></div></div>
            
        </li>
        
        
        <li id="section-88">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>current distance dragged</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		obj.deltaX = event.pageX - dd.pageX;
		obj.deltaY = event.pageY - dd.pageY;</pre></div></div>
            
        </li>
        
        
        <li id="section-89">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>original element position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		obj.originalX = ia.offset.left;
		obj.originalY = ia.offset.top;</pre></div></div>
            
        </li>
        
        
        <li id="section-90">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>adjusted element position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		obj.offsetX = obj.originalX + obj.deltaX; 
		obj.offsetY = obj.originalY + obj.deltaY;</pre></div></div>
            
        </li>
        
        
        <li id="section-91">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>assign the drop targets information</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		obj.drop = drag.flatten( ( ia.drop || [] ).slice() );
		obj.available = drag.flatten( ( ia.droppable || [] ).slice() );
		<span class="hljs-keyword">return</span> obj;	
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-92">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <p>determine is the argument is an element or jquery instance</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	element: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> arg </span>)</span>{
		<span class="hljs-keyword">if</span> ( arg &amp;&amp; ( arg.jquery || arg.nodeType == <span class="hljs-number">1</span> ) )
			<span class="hljs-keyword">return</span> arg;
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-93">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              <p>flatten nested jquery objects and arrays into a single dimension array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	flatten: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> arr </span>)</span>{
		<span class="hljs-keyword">return</span> $.map( arr, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> member </span>)</span>{
			<span class="hljs-keyword">return</span> member &amp;&amp; member.jquery ? $.makeArray( member ) : 
				member &amp;&amp; member.length ? drag.flatten( member ) : member;
		});
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-94">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>toggles text selection attributes ON (true) or OFF (false)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	textselect: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> bool </span>)</span>{ 
		$( <span class="hljs-built_in">document</span> )[ bool ? <span class="hljs-string">"unbind"</span> : <span class="hljs-string">"bind"</span> ](<span class="hljs-string">"selectstart"</span>, drag.dontstart )
			.css(<span class="hljs-string">"MozUserSelect"</span>, bool ? <span class="hljs-string">""</span> : <span class="hljs-string">"none"</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-95">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>.attr(“unselectable”, bool ? “off” : “on” )</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-built_in">document</span>.unselectable = bool ? <span class="hljs-string">"off"</span> : <span class="hljs-string">"on"</span>; 
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-96">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>suppress “selectstart” and “ondragstart” events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	dontstart: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ 
		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; 
	},</pre></div></div>
            
        </li>
        
        
        <li id="section-97">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>a callback instance contructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	callback: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{}
	
};</pre></div></div>
            
        </li>
        
        
        <li id="section-98">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <p>callback methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>drag.callback.prototype = {
	update: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
		<span class="hljs-keyword">if</span> ( $special.drop &amp;&amp; <span class="hljs-keyword">this</span>.available.length )
			$.each( <span class="hljs-keyword">this</span>.available, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> i </span>)</span>{
				$special.drop.locate( <span class="hljs-keyword">this</span>, i );
			});
	}
};</pre></div></div>
            
        </li>
        
        
        <li id="section-99">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>patch $.event.$dispatch to allow suppressing clicks</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> $dispatch = $event.dispatch;
$event.dispatch = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event </span>)</span>{
	<span class="hljs-keyword">if</span> ( $.data( <span class="hljs-keyword">this</span>, <span class="hljs-string">"suppress."</span>+ event.type ) - <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime() &gt; <span class="hljs-number">0</span> ){
		$.removeData( <span class="hljs-keyword">this</span>, <span class="hljs-string">"suppress."</span>+ event.type );
		<span class="hljs-keyword">return</span>;
	}
	<span class="hljs-keyword">return</span> $dispatch.apply( <span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span> );
};</pre></div></div>
            
        </li>
        
        
        <li id="section-100">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <p>event fix hooks for touch events…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> touchHooks = 
$event.fixHooks.touchstart = 
$event.fixHooks.touchmove = 
$event.fixHooks.touchend =
$event.fixHooks.touchcancel = {
	props: <span class="hljs-string">"clientX clientY pageX pageY screenX screenY"</span>.split( <span class="hljs-string">" "</span> ),
	filter: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> event, orig </span>) </span>{
		<span class="hljs-keyword">if</span> ( orig ){
			<span class="hljs-keyword">var</span> touched = ( orig.touches &amp;&amp; orig.touches[<span class="hljs-number">0</span>] )
				|| ( orig.changedTouches &amp;&amp; orig.changedTouches[<span class="hljs-number">0</span>] )
				|| <span class="hljs-literal">null</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-101">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              <p>iOS webkit: touchstart, touchmove, touchend</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="hljs-keyword">if</span> ( touched ) 
				$.each( touchHooks.props, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> i, prop </span>)</span>{
					event[ prop ] = touched[ prop ];
				});
		}
		<span class="hljs-keyword">return</span> event;
	}
};</pre></div></div>
            
        </li>
        
        
        <li id="section-102">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>share the same special event configuration with related events…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$special.draginit = $special.dragstart = $special.dragend = drag;

})( jQuery );</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
